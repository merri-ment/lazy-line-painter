/*
 * Lazy Line Painter
 * SVG Stroke animation.
 *
 * https://github.com/camoconnell/lazy-line-painter
 * http://www.camoconnell.com
 *
 * Licensed under the MIT license.
 *
 */

(function(k){var q={init:function(b){return this.each(function(){var c=k(this),a=c.data("lazyLinePainter");c.addClass("lazy-line");if(!a){var a=k.extend({width:null,height:null,strokeWidth:2,strokeColor:"#000",strokeOverColor:null,strokeCap:"round",strokeJoin:"round",strokeOpacity:1,onComplete:null,onUpdate:null,onStart:null,onStrokeStart:null,onStrokeComplete:null,delay:0,overrideKey:null,drawSequential:!0,speedMultiplier:1,reverse:!1,responsive:!1},b),e=a.overrideKey?a.overrideKey:c.attr("id").replace("#",
""),d=a.svgData[e].dimensions.width,h=a.svgData[e].dimensions.height;a.paths=a.svgData[e].strokepath;null===a.width&&(a.width=d);null===a.height&&(a.height=h);a.responsive||c.css({width:a.width,height:a.height});e="0 0 "+d+" "+h;d=document.createElementNS("http://www.w3.org/2000/svg","svg");d.setAttributeNS(null,"viewBox",e);d.setAttribute("xmlns","http://www.w3.org/2000/svg");e=k(d);a.svg=e;c.append(a.svg);a.longestDuration=0;for(var g=a.playhead=0,d=e=a.delay*a.speedMultiplier,h=h=0;h<a.paths.length;h++)g=
a.paths[h].duration*a.speedMultiplier,d+=g;for(h=0;h<a.paths.length;h++){var l;l=a;var m=h,f=document.createElementNS("http://www.w3.org/2000/svg","path"),g=k(f);l.svg.append(g);g.attr(u(l,l.paths[m]));l=f;m=Math.ceil(l.getTotalLength());f=a.paths[h];f.positions=[];for(g=0;g<m;g++){var n=l.getPointAtLength(g);f.positions.push({x:n.x,y:n.y})}l.style.strokeDasharray=m+" "+m;l.style.strokeDashoffset=m;l.style.display="block";l.getBoundingClientRect();g=f.duration*a.speedMultiplier;g>a.longestDuration&&
(a.longestDuration=g);n=a.reverse?d-=g:a.playhead+e;f.duration=g;f.drawStartTime=n;f.el=l;f.index=h;f.length=m;f.progress=0;f.onStrokeStart=f.onStrokeStart||null;f.onStrokeComplete=f.onStrokeComplete||null;f.onStrokeStartDone=!1;f.onStrokeCompleteDone=!1;f.onStrokeUpdate=f.onStrokeUpdate||null;a.playhead+=g}a.totalDuration=a.drawSequential?a.playhead:a.longestDuration;a.totalDuration+=e;c.data("lazyLinePainter",a);c.lazylinepainter("resize")}})},paint:function(){return this.each(function(){var b=
k(this).data("lazyLinePainter");setTimeout(function(){b.rAF=requestAnimationFrame(function(c){p(c,b)});if(null!==b.onStart)b.onStart()},b.delay)})},pauseResume:function(){return this.each(function(){var b=k(this).data("lazyLinePainter");b.paused?(b.paused=!1,requestAnimationFrame(function(c){v(c,b)})):(b.paused=!0,cancelAnimationFrame(b.rAF))})},erase:function(){return this.each(function(){var b=k(this).data("lazyLinePainter");b.startTime=null;b.elapsedTime=null;cancelAnimationFrame(b.rAF);b.onStrokeCompleteDone=
!1;for(var c=0;c<b.paths.length;c++){var a=b.paths[c];a.el.style.strokeDashoffset=a.length;a.onStrokeCompleteDone=!1;a.onStrokeStartDone=!1}})},destroy:function(){return this.each(function(){var b=k(this);b.removeData("lazyLinePainter");b.remove()})},set:function(b){return this.each(function(){var c=k(this).data("lazyLinePainter");c.elapsedTime=b*c.totalDuration;r(c)})},get:function(){return k(this).data("lazyLinePainter")},resize:function(){this.each(function(){var b=k(this),c=b.data("lazyLinePainter");
c.offset=b.offset();for(b=0;b<c.paths.length;b++)t(c,c.paths[b])})}},v=function(b,c){c.startTime=b-c.elapsedTime;requestAnimationFrame(function(a){p(a,c)})},p=function(b,c){c.startTime||(c.startTime=b);c.elapsedTime=b-c.startTime;r(c);if(c.elapsedTime<c.totalDuration)c.rAF=requestAnimationFrame(function(a){p(a,c)});else if(null!==c.onComplete)c.onComplete()},r=function(b){if(null!==b.onUpdate)b.onUpdate();for(var c=0;c<b.paths.length;c++){var a=b.paths[c],e=void 0;b.drawSequential?(e=b.elapsedTime-
a.drawStartTime,0>e&&(e=0)):e=b.elapsedTime;var d=a;0<e&&e<d.duration?d.progress=e/d.duration:e>=d.duration?d.progress=1:e<=d.drawStartTime&&(d.progress=0);d=a;e=d.progress*d.length;d.el.style.strokeDashoffset=b.reverse||d.reverse?-d.length+e:d.length-e;t(b,a);d=b;if(1===a.progress)d.onStrokeComplete&&d.drawSequential&&!a.onStrokeCompleteDone&&(d.onStrokeComplete(a),a.onStrokeComplete||(a.onStrokeCompleteDone=!0)),a.onStrokeComplete&&d.drawSequential&&!a.onStrokeCompleteDone&&(a.onStrokeComplete(a),
a.onStrokeCompleteDone=!0);else if(1E-5<a.progress&&(d.onStrokeStart&&d.drawSequential&&!a.onStrokeStartDone&&(d.onStrokeStart(a),a.onStrokeStart||(a.onStrokeStartDone=!0)),a.onStrokeStart&&d.drawSequential&&!a.onStrokeStartDone&&(a.onStrokeStart(a),a.onStrokeStartDone=!0),a.onStrokeUpdate))a.onStrokeUpdate(a)}},t=function(b,c){var a=Math.round(c.progress*(c.length-1)),a=c.positions[a];c.position={x:b.offset.left+a.x,y:b.offset.top+a.y}},u=function(b,c){return{d:c.path,stroke:c.strokeColor?c.strokeColor:
b.strokeColor,"fill-opacity":0,"stroke-opacity":c.strokeOpacity?c.strokeOpacity:b.strokeOpacity,"stroke-width":c.strokeWidth?c.strokeWidth:b.strokeWidth,"stroke-linecap":c.strokeCap?c.strokeCap:b.strokeCap,"stroke-linejoin":c.strokeJoin?c.strokeJoin:b.strokeJoin}};k.fn.lazylinepainter=function(b){if(q[b])return q[b].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof b&&b)console.log("opps - issue finding method");else return q.init.apply(this,arguments)}})(jQuery);